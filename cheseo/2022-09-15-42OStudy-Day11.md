# Chapter 3 & 4: 프로세스 관리 (5) & CPU 스케줄링
[프로세스의 생성에 있어 자식 프로세스가 부모 프로세스를 복제, 새로운 과정을 덮어씌우는 과정과 프로세스의 종료에 대해 알아본다.](https://core.ewha.ac.kr/publicview/C0101020170322134548803842)  
[프로세스 생성과 종료에서 쓰이는 네 종류의 시스템 콜, 프로세스 간의 협력에 대해 알아본다.](https://core.ewha.ac.kr/publicview/C0101020170327144547225686)

## 키워드
1. 프로세스 생성
2. 프로세스 종료
3. 시스템 콜

## 내용 정리
### 1. 프로세스 생성 (Process Creation)
부모 프로세스가 자식 프로세스를 생성
- 자식 프로세스는 부모 프로세스의 복제품 
- 부모 프로세스가 시스템 콜, 즉 fork 시스템 콜을 해서 자식 프로세스를 생성

프로세스의 트리(계층 구조) 형성
- 프로세스 하나가 계속 복제 생성

프로세스는 자원을 필요로 함
- 스레드와 달리, 프로세스끼리 자원을 공유하지 않음 (부모와 공유하는 경우도 있으나 이례적)
자원 
- 부모와 자식이 자원을 모두 / 일부를 / 전혀 공유하지 않는 세가지 모델이 있음

수행
- 부모 자식 간의 관계여도 별개의 프로세스이기 때문에 각자 수행됨
- 그러나 자식이 종료(terminated)될 때까지 부모가 기다리는 모델도 있음

주소 공간 (address space)
- 자식은 부모의 주소 공간을 그대로 복사함
- 부모 프로세스가 실행된 부분부터 실행하는 것이 아니라 주소 공간에 새로운 프로그램을 올려서 부모 프로세스와 다른 일을 수행 => exec() 시스템 콜이라고 함

### 2. 프로세스 종료 (process termination)
프로세스가 마지막 명령을 수행한 후 운영체제에게 이를 exit() 시스템 콜로 알림
- 자식 프로세스가 종료될 때 부모 프로세스에게 output data를 보냄 (자식 프로세스가 부모보다 먼저 끝남)
- 정상적으로 종료됐을 때 => exit / 부모 프로세스가 자식 프로세스를 강제 종료시킬 때 => abort
- 자식이 강제 종료되는 경우:
  -  자식이 할당 자원의 한계치를 넘어섬
  -  자식에게 할당된 테스크가 더이상 필요하지 않음 (더이상 시킬 일이 없다)
  -  부모가 종료된 경우: 부모가 죽기 전에 자식 프로세스를 종료 시키고 부모 프로세스를 종료시킴 (트리 구조 아래서 위로 단계적으로 종료시킴)

### 3. 시스템 콜
fork(): 자식 만들어 달라고 요청하는 시스템 콜
- fork를 했을 때 부모, 자식 스래드를 구분하는 법: 
  - fork() 시스템 콜은 pid(process ID)를 리턴하는데 
  - 부모 프로세스가 fork를 호출한 경우 자식의 pid를 리턴 받음
  - 자식은 부모 프로세스가 fork를 호출한 다음 단계부터 실행되니까 pid는 0임
  - 부모가 fork() 호출 => 자식 프로세스 생성 및 실행됨, pid=0 (순서 상관없이 개별적으로 실행되고, 먼저 실행이 끝난 프로세스가 종료됨. 자식 프로세스가 먼저 종료되기까지 부모 프로세스가 기다리게 만드는 시스템 콜 wait가 있음) 

exec(): 부모와 자식이 같은 일을 수행하지 않게 자식에게 새로운 프로그램으로 덮어씌움
- 프로세스 안에 있는 exec() 시스템 콜을 실행하면 새로운 프로세스를 만드는 것이 아니라, 현재 만들어진 exec 인자에 들어가 있는 프로그램 실행 파일을 읽어서 주어진 명령을 실행하고(프로세스에 이 명령을 수행하기 위한 코드들로 주소 공간이 덮어씌워짐) 종료된다. 

wait(): 자식 프로세스가 종료될 때까지 부모 프로세스를 정지(sleep, 즉 blocked) 상태로 만드는 시스템 콜

exit(): 프로세스를 종료시키는 시스템 콜
- 자발적 종료: 마지막 statement 수행 후 exit() 시스템 콜을 통해 종료
- 비자발적 종료: 
  - 자식이 한계치를 넘어서는 자원을 요청하거나 자식이 더이상 필요하지 않아서 부모가 강제 종료 
  - 사람이 kill, break 등으로 강제 종료
  - 부모가 종료되기 전 자식을 정리하는 경우
