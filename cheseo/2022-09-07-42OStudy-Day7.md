# Chapter 2: 컴퓨터시스템의 구조
[인터럽트가 운영체제를 구동시키는 원리와 인터럽트의 한 종류인 시스템콜에 대해 알아본다. 동기식/비동기식 입출력에서의 인터럽트, DMA를 이용한 인터럽트 조절에 대해 알아본다. 계층구조에 의해 I/O에서 입출력명령어가 다름을 이해한다.](https://core.ewha.ac.kr/publicview/C0101020170315134644924991)

## 키워드
1. 동기식 입출력과 비동기식 입출력
2. DMA (Direct Memory Access)
3. 서로 다른 입출력 기계어

## 내용 정리
### 1. 동기식 입출력과 비동기식 입출력
<img width="600" alt="image" src="https://user-images.githubusercontent.com/63505022/188633967-23c9042d-dfeb-4c85-a411-f38877ec0403.png">

#### 동기식 입출력 (synchronous I/O)  
I/O 요청 후 입출력 작업이 완료된 후에만 제아가 사용자 프로그램에게 넘어감  
구현 방법 1:
- I/O가 끝날 때까지 CPU를 낭비시킴
- 매시점 하나의 I/O만 일어날 수 있음
구현 방법 2:
- I/O가 완료될 때까지 해당 프로그램에게서 CPU를 빼앗음
- I/O 처리를 기다리는 줄에 그 프로그램을 줄 세움
- 다른 프로그램에게 CPU를 줌

#### 비동기식 입출력 (asynchronous I/O)
I/O가 시작된 후 입출력 작업이 끝나기를 기다리지 않고 제아가 사용자 프로그램에게 즉시 넘어감  
이게 어떻게 가능?  
- 예를 들어 하드 디스크 파일에 쓰라는 명령이면 꼭 다 써진 것을 확인해야지만 다음 기계어 명령으로 넘어갈 수 있는 것은 아님. 이런 경우 비동기식 훨씬 효율적임.

### DMA (Direct Memory Access)
#### 개요
인터럽트도 하나의 오버헤드. 어떤 I/O 장치들은 처리 속도가 무척 빠르기 때문에 처리를 완료했을 때마다 CPU에 인터럽트를 걸어버리면 오버헤드가 너무 빈번하게 발생함. 그래서 등장한 것이 DMA.
> 📘 오버헤드(overhead)란?
>
> 프로그램의 실행 흐름에서 나타나는 현상 중 하나로, 프로그램 실행도중 간접적인 코드를 실행시킬 때 추가적으로 시간과 메모리와 자원이 사용되는 현상을 의미함. 한마디로 어떤 처리를 하기 위해 들어가는 간접적인 처리 시간, 메모리 등을 의미.  
> 예를 들어 A라는 처리를 단순하게 실행하면 10초가 소요, 안정성으로 고려한 부가적인 B라는 처리를 추가하여 총 15초가 소요 되었다면 오버헤드는 5초다.  

#### 정의
직접 메모리 접근은 특정 하드웨어 하위 시스템(I/O 장치들)이 CPU와 독립적으로 메인 시스템 메모리에 접근할 수 있게 해주는 컴퓨터 시스템의 기능. I/O 컨트롤러가 작업을 완료했을 때 직접 그 작업들을 메모리에 옮겨놓을 수 없음. 메모리는 CPU의 작업 공간이라 오직 CPU만 접근 가능. (그래서 local buffer를 가지고 있는 것임.) 
- 빠른 입출력 장치를 메모리에 가까운 속도로 처리하기 위해 사용
- CPU의 중재 없이 Device Controller(I/O controller)가 디바이스의 buffer storage의 내용을 메모리에 블록 단위로 직접 전송 (상반되는 개념으로 PIO(Programmed Input/Output), 장치들 사이에 전송되는 모든 데이터가 중앙처리장치(CPU)를 거쳐가는 방식이 있음)
- 바이트 단위가 아니라 block 단위로 인터럽트를 발생시킴

### 서로 다른 입출력 기계어(명령어)
<img width="600" alt="image" src="https://user-images.githubusercontent.com/63505022/188646199-22fc3ece-fc6f-4c51-9fcb-41484bf244b9.png">

- I/O를 수행하는 특별 명령어에 의해 (메모리 접근하는 명령어 따로, I/O 수행하는 명령어 따로, 둘의 주소가 다름)
- memory mapped I/O에 의해 (메인 메모리의 주소를 연장하여 실제 I/O를 수행할 때 고유의 명령어를 실행하는 것이 아니라 메모리 접근하는 명령어를 통해서 접근하는 방법)
<img width="600" alt="image" src="https://user-images.githubusercontent.com/63505022/188647374-9e630ee1-dc4e-4b20-99cb-de6bc1f80ac8.png">

- 위로 갈수록 용량은 적으면서 빠르지만 비싸고, 아래로 갈수록 용량은 크면서 느리고 가격은 싼 저장장치 계층 구조. 그래서 모든 데이터의 원본은 아래 쪽 저장장치에 저장되어 있고 필요할 때마다 위로 읽어다가 사용됨. 
- 매번 위에서 요청할 때마다 아래로 내려가사 읽어오면 느리니까 내려가기 이전 메모리를 확인해서 그 메모리를 한 번 가져와서 저장한 적이 있는지 확인하는 작업(캐싱)을 거침
- 메모리에서 실행되고 있는 프로그램, 즉 프로세스는 컴퓨터가 꺼지면 다 날아감(휘발성). 그러나 보조 기억장치들은 비휘발성이라 파일 시스템이나 저장되어야 하는 파일들은 다 거기에 저장되어 있음

## 궁금한 점
1. CPU 스케줄링과 동기식 입출력의 차이가 뭔가? 동기식 입출력의 일환으로 CPU 스케줄링이 있는 건가?
